

## usb传输速率

USB1.0　　 1.5Mbps(192KB/s)　　低速(Low-Speed)　 500mA　　 1996年1月　　

USB1.1　　 12Mbps(1.5MB/s)　　 全速(Full-Speed)　　 500mA　　 1998年9月　　

USB2.0　　 480Mbps(60MB/s)　　高速(High-Speed)　　500mA　　 2000年4月　　

USB3.0　　 5-10Gbps(640MB/s)　超速(Super-Speed)　 900mA　　 2008年11月　


## usb的几种角色

    usb host：是指当前usb作为主设备，能够对已连接的从设备发起主动的会话。
    usb device/slave： 与host模式相对，device模式下，设备只能被动的响应主设备发送的会话请求
    usb otg：设备既可以当host又可以作slave,由两个设备间协商角色

host模式下，usb由usb控制器与hub组成，usb控制器的主要作用是控制数据包在总线上的传输，并且在各个不同的slave设备间进行传输仲裁，hub主要是为了和多个slave进行连接，在hub中，有一个上端口，就是和usb控制器连接的，有多个下端口，与slave设备连接，在一个hub中，最多只能拥有15个下游端口。

## usb的传输模式

在slave模式下，usb被区分为四种传输模式:
- BUIK（块传输）： 追求数据完整性，有校验，可用作大数据传输，并不适合实时传输，代表设备:U盘

- Interrupt(中断传输)：实时性优于BUIK, 并对数据准备性有一定的保证， 代表设备：键盘

- ISO(同步传输) ：追求实时性，无校验，允许一定的数据错误。 代表设备：USB音箱,USB摄像头

- control(控制数据传输) ：是负责向USB设置一些控制信息，传送这种事务的管道是控制管道

  

### 端点（endpoint）

位于USB外设内部，所有通信数据的来源或者目的都基于这些端点，是一个可寻址的先入先出队列。每个USB外设有一个唯一的地址，可能包含最多16个端点。主机通过发出器件地址和每次数据传输的端点号，向一个具体端点发送数据。每个USB谁被中会有很多的endpoiint,最多有16个，但一般的也只有三个,endpoint0用来做传输配置与控制信息，endpoint1用来做in，endpoint2用来做out.
描述符

### 描述符(Descriptor )

是一个完整的数据结构, 存储在USB 设备中, 用于描述一USB 设备的所有属性。USB主机通过一系列命令要求设备发送这些信息。标准的USB设备有5中USB描述符：设备，配置，接口，端点，字符串。






## USB中术语

### 握手应答包( Acknowledge Packet , 简写为 ACK)

用于 USB 主机与设备之间数据传输时 , 指示应答的握手信号。

### 缓冲区( Buffer) 

计算机或者是嵌入式系统中 , 用于暂时存储不能及时或大量传送的数据的内存单元。

### 批量传输( Bulk Tran sfer )

 USB 的 4 种传输类 型之一。 用 于对时间没有特殊要求 ,但总量很大的数据的传输。

### 总线枚举( Bus Enumeration)

 USB 主机对于 USB 设备的检测和配置。

### 控制传输( Control Transfer) 

 USB 的 4 种传输类型之一。 主要用于主机与设备之间配置、命令及状态等数据的传输。

### 设备( Device)

 这是一个非常重要的概念 , 是指能够实现某种 USB 功能的逻辑或物理实体。 USB 协议将设备分为3个层次 :

从最低的层次来讲 , 设备指的就是单个的元件 , 比如一个 Flash 存储设备 ;

从更高一层次来讲 , 设备是能够实现某种特定功能的硬件 的集合体 , 比如 USB 的接口设备 ;

最高层次上的 USB 设备 , 是指其所能够实现的功能。

在文中没有特殊提到时 , 设备指的就 是一个 USB 集线 器或者 是一 种 USB 的功 能。 比如优盘就是一个 USB 设备 , 因为它能实现 USB 的 Mass Storage 的功能。

### 端点( Endpoint , 简写为 EP )

 又一个重要的概念。 从物理机制来说 , 端点可以是嵌入式系统或 PC 上的一个数据缓冲区 , 用来存放和发送 USB 的各种数据; 从逻辑上来说 , 端点可以视为数据的收发器 , 可以按照定义的传输方式来交换数据。每个端点都有惟一确定的地址, 即端点号。 每个端点根据相关硬件芯片的 不同设置成不同的传输特性, 比如输入/ 输出端点、配置端点及批量传输端点等。

### 域( Field)

 USB 协议中规定的组成包的单元。

### 帧( Frame)

 这是一个时间概念 , 指的是从一个 SOF 令牌开始到下一个 SOF 发送 之间的时间 , 其中包含了一系列的数据传送。

### 功能( Function) 

通过 USB 实现的某种作用或任务。 比 如 USB 的数码相机等 , 它同时也是一个 USB 的设备 , 起到了传输照片数据等的功能。

### 人机交互设备( Human Interface Device, 简写 为 HID)

 U SB 协议规定的设备类之一。 常见的 USB 鼠标、键盘等设备均属于HID。Windows 等操作系统对于 HID 有很好的支持, 提供了完整的驱动程序。 HID的PC级开发因此仅需针对应用级用户程序。

### 主机( Host)

 是整个 USB 体系的核心。 它包括主机接口控制器硬件和驱动程序2个层次。

### 集线器( Hub )

 提供 USB 设备到主机的连接点。 能够为相应的 USB 设备提供电源, 并在一定程度上检测和管理连接的 USB 设备。

### 同步传输( Isochronous Transfer )

 4 种 USB 传输类型之一。 适用于对时间有严格要求的数据的传输 , 比如音频数据的传输。 USB 总线能够保证为同步传输提供固定的带宽,并有可能因此占用批量传输等的带宽 , 而优先满足同步传输的需要。

### 最低有效位( Least Significant Bit , 简写为 LSB)。

### 最高有效位( Most Significant Bit , 简写为 MSB)。

移动式 USB( USB On The Go, 简写为 OTG)

 基于 USB 协议 2.0 的补充版本,用于解决 USB 点对点通信的瓶颈。 OTG 既具有 USB 主机的功能 , 又具有 USB 设备的功能 ,并且能够自由地在这两种角色中进行切换。

(19) 包( Packet)。 USB 协议中规定的有一定格式的数据组合。 典型的一个包中 , 包含了该包的信息、传输的数据和校验纠错信 息等 3 部分。 可以说 , 包是 USB 数据传输的最基本单位。

(20) 个人计算机( Personal Computer , 简写为 PC)。

(21) 包标志域( Packet Identified Field, 简写为 PID)。 用于表明包的类型和格式的域。

(22) 即插即用( Play and Plug, 简写为 PnP ) 。 基于 PC 的一项技术 , 用于管 理 I/ O 地址、内存地址和 IRQ 等在内的主机资源 , 使得外部设备能够使用的 PC 中没有冲突的某项资源。

(23) 端口( Port )。 USB 设备的接入点 , 一般由集线器或 USB 主机的根集线器提供。

( 24 ) 事 务 ( Transaction )。 USB 中 基 于 一 个 端 点 的 数 据 发 送 与 接 收 的 行 为。 注 意 与Tran sfer 的区别。

(25) 传输( Transfer) 。 USB 的各种数据发送的总的格 式。包 括 4 种传输类型。 传输由1 笔或多笔事务组成。

(26) 嵌入式 USB 主机 ( Embedded USB Host )。 随着 对 USB 点对点方案的发展, 出现“嵌入式 USB 主机”的解决方案的需求 , 这也是一个新的提法和名称。 指的是在嵌入式系统 中实现 USB 主 机的 功能 , 从功 能上来说 , 它应 该完 全具 备 和 PC 上一 样的所有 USB 主机的功能 , 但是 , 从实现的角度来讲 , 由于与PC有很 大的 不同 , 因此 , 凡 是书 中叙 述有 关 如此内容的时候 , 均会严格标注“嵌入式 USB 主机”。





## 参考链接

1. [usb2.0 协议分析](https://www.cnblogs.com/newjiang/p/9511331.html)
2. https://www.cnblogs.com/jacklong-yin/p/9073433.html
3. https://www.cnblogs.com/cjxltd/p/7125698.html

